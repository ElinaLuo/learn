<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>useReducer实现</title>
</head>
<body>
  <div id="root"></div>
</body>
<!-- 文档链接：https://zh-hans.react.dev/learn/extracting-state-logic-into-a-reducer -->
<!-- This setup is not suitable for production. -->
<!-- Only use it in development! -->
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script async src="https://ga.jspm.io/npm:es-module-shims@1.7.0/dist/es-module-shims.js"></script>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react?dev",
    "react-dom/client": "https://esm.sh/react-dom/client?dev"
  }
}
</script>
<script type="text/babel" data-type="module">
import React, { StrictMode } from 'react';
import { createRoot } from 'react-dom/client';

import { useState } from 'react';

// 实现一个useReducer
function useReducer(fn, initialState) {
  const [state, setState] = useState(initialState);

  const dispatch = (action) => {
    setState(fn(state, action));
  }
  return [state, dispatch];

}

const initList = [1, 2, 3];

const listReducer = (list, action) => {
  switch (action.type) {
    case 'add':
      return [...list, list.length + 1];
    case 'delete':
      list.pop();
      return [...list];
    default:
      throw new Error('Invalid action');
  }
}

function App() {
  const [list, dispatch] = useReducer(listReducer, initList);
  return (
    <>
      <button onClick={() => dispatch({ type: 'add' })}>
        add
      </button>
      <button onClick={() => dispatch({ type: 'delete' })}>
        delete
      </button>
      {list.concat()}
    </>
  );
}


const root = createRoot(document.getElementById('root'));
root.render(
  <StrictMode>
    <App />
  </StrictMode>
);
</script>
<style>
* {
  box-sizing: border-box;
}

body {
  font-family: sans-serif;
  margin: 20px;
  padding: 0;
}
</style>
</html>