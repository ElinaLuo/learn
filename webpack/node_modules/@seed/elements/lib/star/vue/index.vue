<template>
  <div :class="prefixCls('star_wrap')">
    <div :class="prefixCls('star_icon')">
      <span
        v-for="index in STAR"
        :key="index"
        :data-index="index"
        :class="starclass"
        :style="starStyle"
        @click="handleClick"
      ></span>
    </div>
    <div v-if="score" :class="scoreclass" :style="textStyle">{{ score }}</div>
  </div>
</template>

<script>
import '../style/index.less';
import { STAR, handleScore } from '../util/utils';
import { prefixCls } from '@seed/ui-base';

export default {
  name: 'star',
  props: {
    star: {
      type: Number,
      default: 0,
    },
    score: {
      type: [String, Number],
      default: '',
    },
    starStyle: {
      type: Object,
    },
    textStyle: {
      type: Object,
    },
    canClick: {
      type: Boolean,
      default: false,
    },
  },
  data() {
    return { STAR };
  },
  computed: {
    starclass() {
      const _score =
        (handleScore(this.star) &&
          handleScore(this.star)
            .toString()
            .replace('.', '_')) ||
        0;
      return [prefixCls('star'), prefixCls('star_' + _score)];
    },
    scoreclass() {
      const _score =
        (handleScore(this.star) &&
          handleScore(this.star)
            .toString()
            .replace('.', '_')) ||
        0;
      return [prefixCls('star_score'), prefixCls('score_' + _score)];
    },
    getStarStyle() {
      return this.starStyle;
    },
    getTextStyle() {
      return this.starStyle;
    },
  },
  methods: {
    prefixCls(...arg) {
      return prefixCls(...arg);
    },
    handleClick(e) {
      const { index } = e.target.dataset;
      if (this.canClick && index) {
        const _index = Number(index);
        this.$emit('click', _index, this);
      }
    },
  },
};
</script>
