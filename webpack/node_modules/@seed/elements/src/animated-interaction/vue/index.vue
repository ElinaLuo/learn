<template>
  <div :class="aniBoxClasses">
    <i :class="iconClasses" />
    <i :class="iconDotClasses" />
    <div class="seed-num-box" v-if="count > 0 && count < 10000">
      <scroll-num :count="count" :active="active" />
    </div>
    <div
      class="seed-def-text"
      v-if="iconText && iconText.length !== 0 && count <= 0"
    >
      {{ iconText }}
    </div>
    <div class="seed-num-box" v-if="count >= 10000">
      {{ numberCeil(count) }}
    </div>
  </div>
</template>
<script>
import ScrollNum from './scroll-num.vue';
import numberCeil from '../react/number-ceil';
import '../style/index.less';
import { prefixCls } from '@seed/ui-base';
export default {
  name: 'animated-interaction',
  data() {
    return {
      animate: false,
    };
  },
  components: {
    'scroll-num': ScrollNum,
  },
  computed: {
    aniBoxClasses() {
      return `${prefixCls('ani-box')} ${prefixCls(this.iconType)} ${
        this.active ? prefixCls('active') : ''
      }`;
    },
    iconClasses() {
      return `${prefixCls(this.iconType + '-icon' + '-' + this.theme)} ${
        this.animate ? prefixCls('animate ') : ''
      }`;
    },
    iconDotClasses() {
      return this.animate
        ? prefixCls('icon-dot') + ' ' + prefixCls('animate')
        : prefixCls('icon-dot');
    },
    iconText() {
      let text;
      switch (this.iconType) {
        case 'input-like':
          text = '赞';
          break;
        case 'input-collect':
          text = '收藏';
          break;
      }
      return text;
    },
  },

  watch: {
    active(newVal, oldVal) {
      if (newVal && newVal != oldVal) {
        this.animate = true;
      } else {
        this.animate = false;
      }
    },
  },

  props: {
    iconType: String,
    count: Number,
    theme: {
      type: String,
      default: 'dp',
    },
    active: {
      type: Boolean,
      default: false,
    },
  },
};
</script>
